@model List<Efs.ViewModels.CartridgeDetailViewModel>

<div class="modal fade" id="manageCartridge" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h1 class="modal-title fs-5 text-center" id="exampleModalLabel">Manage Cartridge Inventory</h1>
                <button type="button" class="btn-close text-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">

                <div class="table-responsive">
                    <table class="table table-striped text-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>#</th>
                                <th>Printer Brand</th>
                                <th>Printer Model</th>
                                <th>Cartridge Colour</th>
                                <th>Cartridge Number</th>
                                <th>Cartridge PartNo</th>
                                <th>Stock Quantity</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int counter = 1;

                            }
                            @if(Model != null && Model.Any())
                            {
                                @foreach(var item in Model)
                                {
                                    <tr>
                                        <td>@counter</td>
                                        <td>@item.printer_brand</td>
                                        <td>@item.printer_model</td>
                                        <td>@item.cartridge_colour</td>
                                        <td>@item.cartridge_number</td>
                                        <td>@item.cartridge_partNo</td>
                                        <td>@item.stock_quantity</td>
                                        <td>
                                            @if (item != null)
                                            {
                                                <a asp-action="Edit" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#exampleModal"
                                                   data-id="@item.id">
                                                    <i class="fa-solid fa-pen-to-square"></i>
                                                </a>

                                                <span>|</span>

                                                <a asp-action="Delete" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                                   data-id="@item.id">
                                                    <i class="fa-solid fa-trash"></i>
                                                </a>
                                            }
                                            else
                                            {
                                                <span>-</span>
                                            }
                                        </td>
                                    </tr>
                                    counter++;
                                }
                            }
                        </tbody>
                    </table>
                </div>
                <div class="mt-3 text-center">
                    <button type="submit" class="btn btn-success">Save</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>

            </div>

        </div>
    </div>
</div>
@* @model List<Efs.ViewModels.CartridgeDetailViewModel>

<div class="modal fade" id="manageCartridgeData" tabindex="-1" aria-labelledby="manageCartridgeLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-dark text-white">
                <h5 class="modal-title" id="manageCartridgeLabel">Manage Cartridge Inventory</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>ID</th>
                                <th>Printer Brand</th>
                                <th>Printer Model</th>
                                <th>Cartridge Color</th>
                                <th>Cartridge Number</th>
                                <th>Part Number</th>
                                <th>Stock Quantity</th>
                                <th>Created At</th>
                                <th>Updated At</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model != null && Model.Any())
                            {
                                foreach (var cartridge in Model)
                                {
                                    <tr>
                                        <td>@cartridge.id</td>
                                        <td>@cartridge.printer_brand</td>
                                        <td>@cartridge.printer_model</td>
                                        <td>@cartridge.cartridge_colour</td>
                                        <td>@cartridge.cartridge_number</td>
                                        <td>@cartridge.cartridge_partNo</td>
                                        <td>
                                            <div class="input-group">
                                                <input type="number" class="form-control stock-quantity"
                                                       value="@cartridge.stock_quantity" min="0" data-id="@cartridge.id">
                                                <button class="btn btn-outline-primary update-stock" data-id="@cartridge.id">
                                                    <i class="bi bi-check"></i>
                                                </button>
                                            </div>
                                        </td>
                                        <td>@cartridge.createdAt.ToString("yyyy-MM-dd")</td>
                                        <td>@cartridge.updatedAt.ToString("yyyy-MM-dd")</td>
                                        <td>
                                            <div class="btn-group" role="group">
                                                <button type="button" class="btn btn-warning btn-sm edit-cartridge"
                                                        data-id="@cartridge.id">
                                                    <i class="bi bi-pencil"></i> Edit
                                                </button>
                                                <button type="button" class="btn btn-danger btn-sm delete-cartridge"
                                                        data-id="@cartridge.id">
                                                    <i class="bi bi-trash"></i> Delete
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="10" class="text-center">No cartridge data available</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary add-new-cartridge">Add New Cartridge</button>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        // Update stock quantity
        $('.update-stock').on('click', function() {
            const id = $(this).data('id');
            const quantity = $(this).closest('td').find('.stock-quantity').val();

            $.ajax({
                url: '/Admin/UpdateCartridgeStock',
                type: 'POST',
                data: { id: id, stockQuantity: quantity },
                success: function(response) {
                    if(response.success) {
                        alert('Stock updated successfully');
                    } else {
                        alert('Failed to update stock: ' + response.message);
                    }
                },
                error: function() {
                    alert('An error occurred while updating stock');
                }
            });
        });

        // Edit cartridge
        $('.edit-cartridge').on('click', function() {
            const id = $(this).data('id');

            $.ajax({
                url: '/Admin/EditCartridge',
                type: 'GET',
                data: { id: id },
                success: function(response) {
                    $('#manageCartridgeData').modal('hide');
                    $('#addEmployeeModal .modal-content').html($(response).find('.modal-content').html());
                    $('#addEmployeeModal').modal('show');
                },
                error: function() {
                    alert('Failed to load cartridge data for editing');
                }
            });
        });

        // Delete cartridge
        $('.delete-cartridge').on('click', function() {
            if (confirm('Are you sure you want to delete this cartridge?')) {
                const id = $(this).data('id');

                $.ajax({
                    url: '/Admin/DeleteCartridge',
                    type: 'POST',
                    data: { id: id },
                    success: function(response) {
                        if(response.success) {
                            alert('Cartridge deleted successfully');
                            // Reload the modal content to reflect changes
                            $.ajax({
                                url: '/Admin/ManageCartridge',
                                type: 'GET',
                                success: function(response) {
                                    $('#manageCartridgeData .modal-content').html($(response).find('.modal-content').html());
                                }
                            });
                        } else {
                            alert('Failed to delete cartridge: ' + response.message);
                        }
                    },
                    error: function() {
                        alert('An error occurred while deleting the cartridge');
                    }
                });
            }
        });

        // Add new cartridge button
        $('.add-new-cartridge').on('click', function() {
            $('#manageCartridgeData').modal('hide');

            $.ajax({
                url: '/Admin/AddCartridge',
                type: 'GET',
                success: function(response) {
                    $('#addEmployeeModal .modal-content').html($(response).find('.modal-content').html());
                    $('#addEmployeeModal').modal('show');
                },
                error: function() {
                    alert('Failed to load add cartridge form');
                }
            });
        });
    });
</script> *@






     



